!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.bcComment=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){
"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var api={question:function(e){var t=new XMLHttpRequest;t.open("GET","/api/question",!0),t.onreadystatechange=api.ready(t,e),t.send()},post:function(e,t,r){var n=new XMLHttpRequest,o="/api/post/"+encodeURIComponent(e)+"/comment";n.open("POST",o,!0),n.setRequestHeader("Content-Type","application/json"),n.onreadystatechange=api.ready(n,r),n.send(JSON.stringify(data))},ready:function(e,t){return function(){4===e.readyState&&(200===e.status?t(null,JSON.parse(e.responseText)):t(new Error("API error.")))}}},input={string:function(e){return e?e.value.trim():void 0},check:function(e){return e?e.checked:!1},"int":function(e){return e?parseInt(e.value,10):void 0}},validator={string:{is_set:function(e,t){("undefined"==typeof e||0===e.length)&&t.push("__ must be set.")},email:function(e,t){"string"!=typeof e||""===e||e.match(/[^@]+@[^@]+/)||t.push("__ must match email pattern.")},site:function(e,t){"string"!=typeof e||""===e||e.match(/https?:\/\//)||t.push("__ must match URL pattern.")}},check:function(e,t,r){for(var n=[],o=e.validators||[],i=0;i<o.length;i++)o[i].call(null,r,n);for(var a=t.substring(0,1).toUpperCase()+t.substring(1),s=0;s<n.length;s++)n[s]=n[s].replace("__",a);return n}},clazz={list:function(e){return e.className.split(/\s+/)},remove:function(e,t){for(var r=clazz.list(e),n=[],o=0;o<r.length;o++)r[o]!==t&&""!==r[o]&&n.push(r[o]);e.className=n.join(" ")},add:function(e,t){for(var r=clazz.list(e),n=!1,o=0;o<r.length;o++)r[o]===t&&(n=!0);n||r.push(t),e.className=r.join(" ")}},errors={display:function(e,t){clazz.add(e.element.parentNode,"error"),e.error=document.createElement("div"),e.error.innerHTML=t,e.element.parentNode.appendChild(e.error)},remove:function(e){var t=e.element.getAttribute("type");"hidden"!==t&&clazz.remove(e.element.parentNode,"error"),e.error&&(e.error.parentNode.removeChild(e.error),delete e.error)}},reader={read:function(e){var t=!0,r={};return reader.each(e,function(e,n){errors.remove(e);var o=input[e.type](e.element),i=validator.check(e,n,o);i.length>0&&(t=!1,errors.display(e,i.join(" "))),"undefined"!=typeof o&&(r[n]=o)}),{values:r,valid:t}},each:function(e,t){for(var r in e){var n=e[r];n.element&&t(n,r)}}};module.exports=function(e){if("string"==typeof e.form&&(e.form=document.querySelector(e.form)),"string"==typeof e.question&&(e.question=document.querySelector(e.question)),!e.form)throw new Error("Comment form element not specified.");if(!e.question)throw new Error("Verification question element not specified.");if(!e.message)throw new Error("Feedback message/error element not specified.");var t=e.form,r=t.elements,n={post_id:{type:"string",element:r.post_id},reply_to:{type:"string",element:r.reply_to},author:{type:"string",validators:[validator.string.is_set],element:r.author},email:{type:"string",validators:[validator.string.email],element:r.email},site:{type:"string",validators:[validator.string.site],element:r.site},content:{type:"string",validators:[validator.string.is_set],element:r.content},notify:{type:"check",element:r.notify},question:{type:"int",element:r.question},answer:{type:"string",validators:[validator.string.is_set],element:r.answer}};api.question(function(t,r){t||(e.question.innerHTML=r.data.question)}),t.onsubmit=function(){var e=reader.read(n);return console.log(JSON.stringify(e,null,2)),!1}};


},{}]},{},[1])
//# sourceMappingURL=comment.js.map
(1)
});
