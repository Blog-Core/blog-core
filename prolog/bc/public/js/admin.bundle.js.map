{
  "version": 3,
  "sources": [
    "/home/raivo/blog-core/admin/node_modules/browser-pack/_prelude.js",
    "admin.js",
    "api.js",
    "assign.js",
    "editor.js",
    "form_error.js",
    "languages.js",
    "message.js",
    "comments.js",
    "config.js",
    "email.js",
    "login.js",
    "post.js",
    "posts.js",
    "trash.js",
    "user.js",
    "users.js",
    "preview.js",
    "resolve_object.js",
    "spinner.js",
    "view.js",
    "comments_item.js",
    "expandable.js",
    "files_item.js",
    "posts_item.js",
    "trash_item.js",
    "users_item.js"
  ],
  "names": [],
  "mappings": "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",
  "file": "generated.js",
  "sourceRoot": "",
  "sourcesContent": [
    "(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",
    "var api = require('./lib/api');\nvar message = require('./lib/message');\nvar login = require('./lib/pages/login');\nvar posts = require('./lib/pages/posts');\nvar post = require('./lib/pages/post');\nvar users = require('./lib/pages/users');\nvar user = require('./lib/pages/user');\nvar email = require('./lib/pages/email');\nvar comments = require('./lib/pages/comments');\nvar trash = require('./lib/pages/trash');\nvar config = require('./lib/pages/config');\n\n// Errors binding.\nrequire('./lib/form_error');\n\n// Global to format dates.\nwindow.formatDate = function(ts) {\n    return new Date(1000 * ts).toISOString().substring(0, 10);\n};\n\n// The page menu.\nvar menu = {\n    active: ko.observable(),\n    types: ko.observable(),\n    load: function() {\n        if (menu.types()) {\n            // Menu updated.\n            return Promise.resolve(menu.types());\n        }\n\n        return api.types().then(function(types) {\n            menu.types(types);\n            return types;\n        });\n    }\n};\n\n// Binds menu.\nko.applyBindings(menu,\n    document.getElementById('menu'));\n\n// Returns true when user is authenticated.\n// Redirects user if he/she is not\n// authenticated.\nfunction authenticated() {\n    if (api.hasKey()) {\n        // If user is authenticated then\n        // check if custom menu entries need\n        // reloading.\n        menu.load().catch(message.error);\n        return true;\n    } else {\n        route.go('login');\n    }\n    return false;\n}\n\nvar recovered;\n\n// Offers recovery option and returns\n// true when user accepts it.\nfunction recovery() {\n    // Offer recover option to the user.\n    var autosave = localStorage.getItem('autosave');\n    if (autosave) {\n        var data = JSON.parse(autosave);\n        // Remove entry from localStorage.\n        localStorage.removeItem('autosave');\n        // Ask confirmation.\n        if (confirm('You have unsaved entry \"' + data.title + '\",' +\n            ' would you like to recover it?')) {\n            // Assign global data that is used for\n            // actual recovery.\n            recovered = data;\n            // Redirect to transient route.\n            route.go('recover');\n            return true;\n        }\n    }\n    return false;\n}\n\n// Transient route for recovering\n// an entry.\nroute(/^recover$/, function() {\n    if (authenticated() && !recovery()) {\n        if (recovered) {\n            if (recovered.$id) {\n                // Recover existing post.\n                route.go('entry/' + recovered.type +\n                    '/' + recovered.$id);\n            } else {\n                // Recover new post.\n                route.go('new/' + recovered.type);\n            }\n        } else {\n            route.go('landing');\n        }\n    }\n});\n\nroute(/^config$/, function() {\n    if (authenticated() && !recovery()) {\n        menu.active('config');\n        config.create().catch(message.error);\n    }\n});\n\nroute(/^entries\\/([^\\/]+)/, function(type) {\n    if (authenticated() && !recovery()) {\n        menu.active(type);\n        posts.create(type).catch(message.error);\n    }\n});\n\nroute(/^entry\\/([^\\/]+)\\/([^\\/]+)/, function(type, id) {\n    if (authenticated() && !recovery()) {\n        menu.active(type);\n        // Include recovery data (can be undefined).\n        post.create(type, id, recovered).catch(message.error);\n        recovered = undefined;\n    }\n});\n\nroute(/^new\\/([^\\/]+)/, function(type) {\n    if (authenticated() && !recovery()) {\n        menu.active(type);\n        // Include recovery data (can be undefined).\n        post.create(type, null, recovered).catch(message.error);\n        recovered = undefined;\n    }\n});\n\nroute(/^comments\\/([^\\/]+)\\/([^\\/]+)/, function(type, id) {\n    if (authenticated() && !recovery()) {\n        menu.active(type);\n        comments.create(type, id).catch(message.error);\n    }\n});\n\nroute(/^trash/, function() {\n    if (authenticated() && !recovery()) {\n        menu.active('trash');\n        trash.create().catch(message.error);\n    }\n});\n\nroute(/^users/, function() {\n    if (authenticated() && !recovery()) {\n        menu.active('users');\n        users.create().catch(message.error);\n    }\n});\n\nroute(/^user\\/new/, function() {\n    if (authenticated() && !recovery()) {\n        menu.active('users');\n        user.create().catch(message.error);\n    }\n});\n\nroute(/^user\\/([^\\/]+)/, function(id) {\n    if (authenticated() && !recovery()) {\n        menu.active('users');\n        user.create(id).catch(message.error);\n    }\n});\n\nroute(/^login/, function() {\n    menu.active(null);\n    login.create().catch(message.error);\n});\n\nroute(/^email/, function() {\n    if (authenticated() && !recovery()) {\n        menu.active('email');\n        email.create().catch(message.error);\n    }\n});\n\nroute(/^logout/, function() {\n    sessionStorage.removeItem('api-key');\n    localStorage.removeItem('api-key');\n    window.location = '/admin';\n});\n\n// Temporary route that decides\n// where to go.\nroute(/^landing/, function() {\n    menu.active(null);\n    menu.load().then(function(types) {\n        if (types.length > 0) {\n            // Select first type.\n            route.go('entries/' + types[0].name);\n        }\n    }).catch(message.error);\n});\n\nroute(/.*/, function() {\n    route.go(api.hasKey() ? 'landing' : 'login');\n});\n\ndocument.body.addEventListener('click', function(e) {\n    if (e.target.href && e.target.href.match(/#logout$/)) {\n        if (confirm('Do you want to log out?')) {\n            return true;\n        } else {\n            e.stopPropagation();\n            e.preventDefault();\n            return false;\n        }\n    }\n}, false);\n",
    "var spinner = require('./spinner');\n\nvar showCount = 0;\n\nfunction spinnerShow() {\n    if (showCount === 0) {\n        spinner.show();\n    }\n    showCount += 1;\n}\n\nfunction spinnerHide() {\n    showCount -= 1;\n    if (showCount === 0) {\n        spinner.hide();\n    }\n}\n\nfunction fetchGet(url) {\n    spinnerShow();\n    return fetch(url, {\n        headers: {\n            'Accept': 'application/json',\n            'X-Key': apiKey()\n        }\n    }).catch(function(err) {\n        spinnerHide();\n        throw err;\n    }).then(handleResponse);\n}\n\nfunction fetchDelete(url) {\n    spinnerShow();\n    return fetch(url, {\n        method: 'DELETE',\n        headers: {\n            'Accept': 'application/json',\n            'X-Key': apiKey()\n        }\n    }).catch(function(err) {\n        spinnerHide();\n        throw err;\n    }).then(handleResponse);\n}\n\nfunction fetchPost(url, data, noauth) {\n    spinnerShow();\n    var headers = {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n    };\n    if (!noauth) {\n        headers['X-Key'] = apiKey();\n    }\n    return fetch(url, {\n        method: 'POST',\n        headers: headers,\n        body: JSON.stringify(data)\n    }).catch(function(err) {\n        spinnerHide();\n        throw err;\n    }).then(handleResponse);\n}\n\nfunction fetchUpdate(url, data) {\n    spinnerShow();\n    return fetch(url, {\n        method: 'PUT',\n        headers: {\n            'Accept': 'application/json',\n            'Content-Type': 'application/json',\n            'X-Key': apiKey()\n        },\n        body: JSON.stringify(data)\n    }).catch(function(err) {\n        spinnerHide();\n        throw err;\n    }).then(handleResponse);\n}\n\nfunction fetchUploadFile(url, file) {\n    spinnerShow();\n    return fetch(url, {\n        method: 'POST',\n        headers: {\n            'Accept': 'application/json',\n            'Content-Type': 'application/octet-stream',\n            'X-Key': apiKey(),\n            'X-File-Name': file.name\n        },\n        body: file\n    }).catch(function(err) {\n        spinnerHide();\n        throw err;\n    }).then(handleResponse);\n}\n\nfunction handleResponse(response) {\n    spinnerHide();\n    return response.json().then(function(json) {\n        if (json.status === 'success') {\n            return json.data;\n        } else {\n            var err = new Error('API response is not success: ' + json.message);\n            err.jsendMessage = json.message;\n            throw err;\n        }\n    });\n}\n\n// Uploads entry file.\nexports.upload = function(id, file) {\n    return fetchUploadFile('/api/upload/' + encodeURIComponent(id), file);\n};\n\n// Login with credentials.\nexports.login = function(username, password) {\n    return fetchPost('/api/auth', {\n        username: username, password: password }, true);\n};\n\n// List of entries.\nexports.posts = function(type) {\n    return fetchGet('/api/entries/' + encodeURIComponent(type));\n};\n\n// The given entry.\nexports.post = function(id) {\n    return fetchGet('/api/entry/' + encodeURIComponent(id));\n};\n\n// The entry info.\nexports.entryInfo = function(id) {\n    return fetchGet('/api/entry/' + encodeURIComponent(id) + '/info');\n};\n\n// Retrieves the given entry comments.\nexports.comments = function(id) {\n    return fetchGet('/api/post/' + encodeURIComponent(id) + '/comments');\n};\n\n// Removes the given comment.\nexports.removeComment = function(entryId, id) {\n    return fetchDelete('/api/comment/' + encodeURIComponent(entryId) +\n            '/' + encodeURIComponent(id));\n};\n\n// Updates the given post.\nexports.updatePost = function(id, data) {\n    return fetchUpdate('/api/entry/' + encodeURIComponent(id), data);\n};\n\n// Saves the given post.\nexports.savePost = function(data) {\n    return fetchPost('/api/entry', data);\n};\n\n// Removes the given post.\nexports.removePost = function(id) {\n    return fetchDelete('/api/entry/' + encodeURIComponent(id));\n};\n\n// Finds entry files.\nexports.files = function(entryId) {\n    return fetchGet('/api/files/' + encodeURIComponent(entryId));\n};\n\n// Removes the given entry file.\nexports.removeFile = function(entryId, file) {\n    return fetchDelete('/api/file/' + encodeURIComponent(entryId) +\n            '/' + encodeURIComponent(file));\n};\n\n// Retrieves all users.\nexports.users = function() {\n    return fetchGet('/api/users');\n};\n\n// Retrieves the given user.\nexports.user = function(id) {\n    return fetchGet('/api/user/' + encodeURIComponent(id));\n};\n\n// Retrieves the current user info.\nexports.userInfo = function() {\n    return fetchGet('/api/user/info');\n};\n\n// Updates the given user.\nexports.updateUser = function(id, data) {\n    return fetchUpdate('/api/user/' + encodeURIComponent(id), data);\n};\n\n// Saves the new user.\nexports.saveUser = function(data) {\n    return fetchPost('/api/user', data);\n};\n\n// Removes the given user.\nexports.removeUser = function(id) {\n    return fetchDelete('/api/user/' + encodeURIComponent(id));\n};\n\n// Finds entry types.\nexports.types = function() {\n    return fetchGet('/api/types');\n};\n\n// Finds entry type info.\nexports.typeInfo = function(type) {\n    return fetchGet('/api/type/' + encodeURIComponent(type));\n};\n\n// Finds user roles.\nexports.roles = function() {\n    return fetchGet('/api/roles');\n};\n\n// Finds trash items.\nexports.trash = function() {\n    return fetchGet('/api/trash');\n};\n\n// Removes the given entry from trash.\nexports.removeFromTrash = function(id) {\n    return fetchDelete('/api/trash/' + encodeURIComponent(id));\n};\n\n// Purges the whole trash.\nexports.purge = function() {\n    return fetchDelete('/api/trash');\n};\n\n// Restores item in trash.\nexports.restore = function(id) {\n    return fetchUpdate('/api/restore/' + encodeURIComponent(id));\n};\n\n// Finds configuration entries.\nexports.config = function() {\n    return fetchGet('/api/configs');\n};\n\n// Updates configuration entries.\n// Takes array of objects with name and\n// value properties.\nexports.updateConfig = function(array) {\n    return fetchUpdate('/api/configs', array);\n};\n\n// Tests the given mail settings.\nexports.testMail = function(settings) {\n    return fetchPost('/api/mail/test', settings);\n};\n\n// List of all tags for the type.\nexports.tags = function(type) {\n    return fetchGet('/api/tags/' + encodeURIComponent(type) + '/all');\n};\n\n// Retrieves image size for the file.\nexports.imageSize = function(entryId, file) {\n    return fetchGet('/api/image/size/' + encodeURIComponent(entryId) +\n        '/' + encodeURIComponent(file));\n};\n\n// Actions associated with the post.\nexports.actions = function(id) {\n    return fetchGet('/api/actions/' + encodeURIComponent(id));\n};\n\nexports.execute = function(id, action) {\n    var url = '/api/action/' + encodeURIComponent(id) + '/' +\n        encodeURIComponent(action);\n    return fetchUpdate(url);\n};\n\n// Checks whether the API key has been set.\nexports.hasKey = function() {\n    return !!(sessionStorage.getItem('api-key') ||\n        localStorage.getItem('api-key'));\n};\n\nvar apiKey = exports.apiKey = function() {\n    var key = sessionStorage.getItem('api-key') ||\n        localStorage.getItem('api-key');\n    if (!key) {\n        throw new Error('API key is not set');\n    }\n    return key;\n};\n",
    "// Copies properties from one object to another.\nmodule.exports = function(to, from) {\n    Object.keys(from).forEach(function(key) {\n        to[key] = from[key];\n    });\n};\n",
    "var editor;\n\n// Enables editor for the current page.\nexports.enable = function() {\n    // Setup Ace\n    editor = ace.edit('editor');\n    editor.$blockScrolling = Infinity;\n    editor.container.style.lineHeight = 1.5;\n    editor.setOptions({\n        maxLines: Infinity,\n        showLineNumbers: false,\n        wrap: true,\n        showPrintMargin: false,\n        showFoldWidgets: false,\n        showGutter: false,\n        displayIndentGuides: false,\n        fontSize: 14,\n        fontFamily: 'monospace',\n        useSoftTabs: true,\n        tabSize: 2\n    });\n    // Theme\n    editor.setTheme('ace/theme/github');\n    // Mode\n    editor.getSession().setMode('ace/mode/markdown');\n};\n\n// Sets the softWrap property for the editor.\nexports.setSoftWrap = function(softWrap) {\n    if (editor) {\n        editor.getSession().setWrapLimitRange(softWrap, softWrap);\n    }\n};\n\n// Sets the font size used by the editor.\nexports.setFontSize = function(size) {\n    if (editor) {\n        editor.setOption('fontSize', size);\n    }\n};\n\n// Sets the editor content\n// and initial cursor position.\nexports.begin = function(content) {\n    editor.setValue(content);\n    // Remove editor's undo log.\n    editor.getSession().setUndoManager(new ace.UndoManager());\n    // Go to first line\n    editor.focus();\n    editor.gotoLine(1);\n};\n\n// Sets callback to be called\n// when editor contents is modified.\nexports.change = function(callback) {\n    editor.on('change', callback);\n};\n\n// Focuses on the editor.\nexports.focus = function() {\n    editor.focus();\n};\n\n// Returns the current editor\n// content.\nexports.content = function() {\n    return editor.getValue();\n};\n\n// Inserts into current ACE editor\n// at the cursor.\nexports.insert = function(text) {\n    if (editor) {\n        editor.insert(text);\n    }\n};\n\n// Sets editor content.\nexports.setValue = function(text) {\n    if (editor) {\n        editor.setValue(text);\n    }\n};\n\n// Cleans up the current editor.\n// FIXME remove change callback\nexports.dispose = function() {\n    if (editor) {\n        editor.destroy();\n        editor = null;\n    }\n};\n",
    "function setErrors(element, valueAccessor) {\n    var value = ko.unwrap(valueAccessor());\n    if (value.length > 0) {\n        var span = element.querySelector('.ko-input-error');\n        if (!span) {\n            // No existing error display.\n            if (!element.className.match(/has\\-error/)) {\n                element.className = element.className + ' has-error';\n            }\n            span = document.createElement('span');\n            span.className = 'help-block ko-input-error';\n            // Finds the holder element.\n            var holder = element.querySelector('.checkbox');\n            if (!holder) {\n                holder = element.querySelector('.form-control');\n            }\n            holder.parentNode.appendChild(span);\n        }\n        // Update errors display.\n        span.innerHTML = value.join(' ');\n    } else {\n        // Removes error class and messages.\n        element.className = element.className.replace(/has\\-error/, '');\n        element.className = element.className.replace(/\\s+/, ' ');\n        var error = element.querySelector('.ko-input-error');\n        if (error) {\n            error.parentNode.removeChild(error);\n        }\n    }\n}\n\n// Defines the errors binding.\nko.bindingHandlers.errors = {\n    init: function(element, valueAccessor) {\n        setErrors(element, valueAccessor);\n    },\n    update: function(element, valueAccessor, allBindings) {\n        setErrors(element, valueAccessor);\n    }\n};\n",
    "// http://stackoverflow.com/questions/3217492/list-of-language-codes-in-yaml-or-json\n// @author Phil Teare\n// using Wikipedia data\nmodule.exports = [\n    {\n        'code': 'ab',\n        'name': 'Abkhaz'\n    },\n    {\n        'code': 'aa',\n        'name': 'Afar'\n    },\n    {\n        'code': 'af',\n        'name': 'Afrikaans'\n    },\n    {\n        'code': 'ak',\n        'name': 'Akan'\n    },\n    {\n        'code': 'sq',\n        'name': 'Albanian'\n    },\n    {\n        'code': 'am',\n        'name': 'Amharic'\n    },\n    {\n        'code': 'ar',\n        'name': 'Arabic'\n    },\n    {\n        'code': 'an',\n        'name': 'Aragonese'\n    },\n    {\n        'code': 'hy',\n        'name': 'Armenian'\n    },\n    {\n        'code': 'as',\n        'name': 'Assamese'\n    },\n    {\n        'code': 'av',\n        'name': 'Avaric'\n    },\n    {\n        'code': 'ae',\n        'name': 'Avestan'\n    },\n    {\n        'code': 'ay',\n        'name': 'Aymara'\n    },\n    {\n        'code': 'az',\n        'name': 'Azerbaijani'\n    },\n    {\n        'code': 'bm',\n        'name': 'Bambara'\n    },\n    {\n        'code': 'ba',\n        'name': 'Bashkir'\n    },\n    {\n        'code': 'eu',\n        'name': 'Basque'\n    },\n    {\n        'code': 'be',\n        'name': 'Belarusian'\n    },\n    {\n        'code': 'bn',\n        'name': 'Bengali'\n    },\n    {\n        'code': 'bh',\n        'name': 'Bihari'\n    },\n    {\n        'code': 'bi',\n        'name': 'Bislama'\n    },\n    {\n        'code': 'bs',\n        'name': 'Bosnian'\n    },\n    {\n        'code': 'br',\n        'name': 'Breton'\n    },\n    {\n        'code': 'bg',\n        'name': 'Bulgarian'\n    },\n    {\n        'code': 'my',\n        'name': 'Burmese'\n    },\n    {\n        'code': 'ca',\n        'name': 'Catalan; Valencian'\n    },\n    {\n        'code': 'ch',\n        'name': 'Chamorro'\n    },\n    {\n        'code': 'ce',\n        'name': 'Chechen'\n    },\n    {\n        'code': 'ny',\n        'name': 'Chichewa; Chewa; Nyanja'\n    },\n    {\n        'code': 'zh',\n        'name': 'Chinese'\n    },\n    {\n        'code': 'cv',\n        'name': 'Chuvash'\n    },\n    {\n        'code': 'kw',\n        'name': 'Cornish'\n    },\n    {\n        'code': 'co',\n        'name': 'Corsican'\n    },\n    {\n        'code': 'cr',\n        'name': 'Cree'\n    },\n    {\n        'code': 'hr',\n        'name': 'Croatian'\n    },\n    {\n        'code': 'cs',\n        'name': 'Czech'\n    },\n    {\n        'code': 'da',\n        'name': 'Danish'\n    },\n    {\n        'code': 'dv',\n        'name': 'Divehi; Dhivehi; Maldivian;'\n    },\n    {\n        'code': 'nl',\n        'name': 'Dutch'\n    },\n    {\n        'code': 'en',\n        'name': 'English'\n    },\n    {\n        'code': 'eo',\n        'name': 'Esperanto'\n    },\n    {\n        'code': 'et',\n        'name': 'Estonian'\n    },\n    {\n        'code': 'ee',\n        'name': 'Ewe'\n    },\n    {\n        'code': 'fo',\n        'name': 'Faroese'\n    },\n    {\n        'code': 'fj',\n        'name': 'Fijian'\n    },\n    {\n        'code': 'fi',\n        'name': 'Finnish'\n    },\n    {\n        'code': 'fr',\n        'name': 'French'\n    },\n    {\n        'code': 'ff',\n        'name': 'Fula; Fulah; Pulaar; Pular'\n    },\n    {\n        'code': 'gl',\n        'name': 'Galician'\n    },\n    {\n        'code': 'ka',\n        'name': 'Georgian'\n    },\n    {\n        'code': 'de',\n        'name': 'German'\n    },\n    {\n        'code': 'el',\n        'name': 'Greek, Modern'\n    },\n    {\n        'code': 'gn',\n        'name': 'Guaraní'\n    },\n    {\n        'code': 'gu',\n        'name': 'Gujarati'\n    },\n    {\n        'code': 'ht',\n        'name': 'Haitian; Haitian Creole'\n    },\n    {\n        'code': 'ha',\n        'name': 'Hausa'\n    },\n    {\n        'code': 'he',\n        'name': 'Hebrew (modern)'\n    },\n    {\n        'code': 'hz',\n        'name': 'Herero'\n    },\n    {\n        'code': 'hi',\n        'name': 'Hindi'\n    },\n    {\n        'code': 'ho',\n        'name': 'Hiri Motu'\n    },\n    {\n        'code': 'hu',\n        'name': 'Hungarian'\n    },\n    {\n        'code': 'is',\n        'name': 'Icelandic'\n    },\n    {\n        'code': 'io',\n        'name': 'Ido'\n    },\n    {\n        'code': 'ig',\n        'name': 'Igbo'\n    },\n    {\n        'code': 'id',\n        'name': 'Indonesian'\n    },\n    {\n        'code': 'ia',\n        'name': 'Interlingua'\n    },\n    {\n        'code': 'ie',\n        'name': 'Interlingue'\n    },\n    {\n        'code': 'iu',\n        'name': 'Inuktitut'\n    },\n    {\n        'code': 'ik',\n        'name': 'Inupiaq'\n    },\n    {\n        'code': 'ga',\n        'name': 'Irish'\n    },\n    {\n        'code': 'it',\n        'name': 'Italian'\n    },\n    {\n        'code': 'ja',\n        'name': 'Japanese'\n    },\n    {\n        'code': 'jv',\n        'name': 'Javanese'\n    },\n    {\n        'code': 'kl',\n        'name': 'Kalaallisut, Greenlandic'\n    },\n    {\n        'code': 'kn',\n        'name': 'Kannada'\n    },\n    {\n        'code': 'kr',\n        'name': 'Kanuri'\n    },\n    {\n        'code': 'ks',\n        'name': 'Kashmiri'\n    },\n    {\n        'code': 'kk',\n        'name': 'Kazakh'\n    },\n    {\n        'code': 'km',\n        'name': 'Khmer'\n    },\n    {\n        'code': 'ki',\n        'name': 'Kikuyu, Gikuyu'\n    },\n    {\n        'code': 'rw',\n        'name': 'Kinyarwanda'\n    },\n    {\n        'code': 'ky',\n        'name': 'Kirghiz, Kyrgyz'\n    },\n    {\n        'code': 'rn',\n        'name': 'Kirundi'\n    },\n    {\n        'code': 'kv',\n        'name': 'Komi'\n    },\n    {\n        'code': 'kg',\n        'name': 'Kongo'\n    },\n    {\n        'code': 'ko',\n        'name': 'Korean'\n    },\n    {\n        'code': 'ku',\n        'name': 'Kurdish'\n    },\n    {\n        'code': 'kj',\n        'name': 'Kwanyama, Kuanyama'\n    },\n    {\n        'code': 'lo',\n        'name': 'Lao'\n    },\n    {\n        'code': 'la',\n        'name': 'Latin'\n    },\n    {\n        'code': 'lv',\n        'name': 'Latvian'\n    },\n    {\n        'code': 'li',\n        'name': 'Limburgish, Limburgan, Limburger'\n    },\n    {\n        'code': 'ln',\n        'name': 'Lingala'\n    },\n    {\n        'code': 'lt',\n        'name': 'Lithuanian'\n    },\n    {\n        'code': 'lu',\n        'name': 'Luba-Katanga'\n    },\n    {\n        'code': 'lg',\n        'name': 'Luganda'\n    },\n    {\n        'code': 'lb',\n        'name': 'Luxembourgish, Letzeburgesch'\n    },\n    {\n        'code': 'mk',\n        'name': 'Macedonian'\n    },\n    {\n        'code': 'mg',\n        'name': 'Malagasy'\n    },\n    {\n        'code': 'ms',\n        'name': 'Malay'\n    },\n    {\n        'code': 'ml',\n        'name': 'Malayalam'\n    },\n    {\n        'code': 'mt',\n        'name': 'Maltese'\n    },\n    {\n        'code': 'gv',\n        'name': 'Manx'\n    },\n    {\n        'code': 'mr',\n        'name': 'Marathi (Marāṭhī)'\n    },\n    {\n        'code': 'mh',\n        'name': 'Marshallese'\n    },\n    {\n        'code': 'mn',\n        'name': 'Mongolian'\n    },\n    {\n        'code': 'mi',\n        'name': 'Māori'\n    },\n    {\n        'code': 'na',\n        'name': 'Nauru'\n    },\n    {\n        'code': 'nv',\n        'name': 'Navajo, Navaho'\n    },\n    {\n        'code': 'ng',\n        'name': 'Ndonga'\n    },\n    {\n        'code': 'ne',\n        'name': 'Nepali'\n    },\n    {\n        'code': 'nd',\n        'name': 'North Ndebele'\n    },\n    {\n        'code': 'se',\n        'name': 'Northern Sami'\n    },\n    {\n        'code': 'no',\n        'name': 'Norwegian'\n    },\n    {\n        'code': 'nb',\n        'name': 'Norwegian Bokmål'\n    },\n    {\n        'code': 'nn',\n        'name': 'Norwegian Nynorsk'\n    },\n    {\n        'code': 'ii',\n        'name': 'Nuosu'\n    },\n    {\n        'code': 'oc',\n        'name': 'Occitan'\n    },\n    {\n        'code': 'oj',\n        'name': 'Ojibwe, Ojibwa'\n    },\n    {\n        'code': 'cu',\n        'name': 'Old Church Slavonic, Church Slavic, Church Slavonic, Old Bulgarian, Old Slavonic'\n    },\n    {\n        'code': 'or',\n        'name': 'Oriya'\n    },\n    {\n        'code': 'om',\n        'name': 'Oromo'\n    },\n    {\n        'code': 'os',\n        'name': 'Ossetian, Ossetic'\n    },\n    {\n        'code': 'pa',\n        'name': 'Panjabi, Punjabi'\n    },\n    {\n        'code': 'ps',\n        'name': 'Pashto, Pushto'\n    },\n    {\n        'code': 'fa',\n        'name': 'Persian'\n    },\n    {\n        'code': 'pl',\n        'name': 'Polish'\n    },\n    {\n        'code': 'pt',\n        'name': 'Portuguese'\n    },\n    {\n        'code': 'pi',\n        'name': 'Pāli'\n    },\n    {\n        'code': 'qu',\n        'name': 'Quechua'\n    },\n    {\n        'code': 'ro',\n        'name': 'Romanian, Moldavian, Moldovan'\n    },\n    {\n        'code': 'rm',\n        'name': 'Romansh'\n    },\n    {\n        'code': 'ru',\n        'name': 'Russian'\n    },\n    {\n        'code': 'sm',\n        'name': 'Samoan'\n    },\n    {\n        'code': 'sg',\n        'name': 'Sango'\n    },\n    {\n        'code': 'sa',\n        'name': 'Sanskrit (Saṁskṛta)'\n    },\n    {\n        'code': 'sc',\n        'name': 'Sardinian'\n    },\n    {\n        'code': 'gd',\n        'name': 'Scottish Gaelic; Gaelic'\n    },\n    {\n        'code': 'sr',\n        'name': 'Serbian'\n    },\n    {\n        'code': 'sn',\n        'name': 'Shona'\n    },\n    {\n        'code': 'sd',\n        'name': 'Sindhi'\n    },\n    {\n        'code': 'si',\n        'name': 'Sinhala, Sinhalese'\n    },\n    {\n        'code': 'sk',\n        'name': 'Slovak'\n    },\n    {\n        'code': 'sl',\n        'name': 'Slovene'\n    },\n    {\n        'code': 'so',\n        'name': 'Somali'\n    },\n    {\n        'code': 'nr',\n        'name': 'South Ndebele'\n    },\n    {\n        'code': 'st',\n        'name': 'Southern Sotho'\n    },\n    {\n        'code': 'es',\n        'name': 'Spanish; Castilian'\n    },\n    {\n        'code': 'su',\n        'name': 'Sundanese'\n    },\n    {\n        'code': 'sw',\n        'name': 'Swahili'\n    },\n    {\n        'code': 'ss',\n        'name': 'Swati'\n    },\n    {\n        'code': 'sv',\n        'name': 'Swedish'\n    },\n    {\n        'code': 'tl',\n        'name': 'Tagalog'\n    },\n    {\n        'code': 'ty',\n        'name': 'Tahitian'\n    },\n    {\n        'code': 'tg',\n        'name': 'Tajik'\n    },\n    {\n        'code': 'ta',\n        'name': 'Tamil'\n    },\n    {\n        'code': 'tt',\n        'name': 'Tatar'\n    },\n    {\n        'code': 'te',\n        'name': 'Telugu'\n    },\n    {\n        'code': 'th',\n        'name': 'Thai'\n    },\n    {\n        'code': 'bo',\n        'name': 'Tibetan Standard, Tibetan, Central'\n    },\n    {\n        'code': 'ti',\n        'name': 'Tigrinya'\n    },\n    {\n        'code': 'to',\n        'name': 'Tonga (Tonga Islands)'\n    },\n    {\n        'code': 'ts',\n        'name': 'Tsonga'\n    },\n    {\n        'code': 'tn',\n        'name': 'Tswana'\n    },\n    {\n        'code': 'tr',\n        'name': 'Turkish'\n    },\n    {\n        'code': 'tk',\n        'name': 'Turkmen'\n    },\n    {\n        'code': 'tw',\n        'name': 'Twi'\n    },\n    {\n        'code': 'ug',\n        'name': 'Uighur, Uyghur'\n    },\n    {\n        'code': 'uk',\n        'name': 'Ukrainian'\n    },\n    {\n        'code': 'ur',\n        'name': 'Urdu'\n    },\n    {\n        'code': 'uz',\n        'name': 'Uzbek'\n    },\n    {\n        'code': 've',\n        'name': 'Venda'\n    },\n    {\n        'code': 'vi',\n        'name': 'Vietnamese'\n    },\n    {\n        'code': 'vo',\n        'name': 'Volapük'\n    },\n    {\n        'code': 'wa',\n        'name': 'Walloon'\n    },\n    {\n        'code': 'cy',\n        'name': 'Welsh'\n    },\n    {\n        'code': 'fy',\n        'name': 'Western Frisian'\n    },\n    {\n        'code': 'wo',\n        'name': 'Wolof'\n    },\n    {\n        'code': 'xh',\n        'name': 'Xhosa'\n    },\n    {\n        'code': 'yi',\n        'name': 'Yiddish'\n    },\n    {\n        'code': 'yo',\n        'name': 'Yoruba'\n    },\n    {\n        'code': 'za',\n        'name': 'Zhuang, Chuang'\n    }\n];\n",
    "// Shows informational message.\nexports.info = function(text) {\n    var messages = document.getElementById('messages');\n    var message = document.createElement('div');\n    message.className = 'alert alert-success message';\n    message.innerHTML = text;\n    messages.appendChild(message);\n    setTimeout(function() {\n        messages.removeChild(message);\n    }, 2000);\n};\n\n// Shows error message.\nexports.error = function(err) {\n    var button = document.createElement('button');\n    button.className = 'close';\n    button.innerHTML = '&times;';\n    var text = document.createElement('span');\n    text.innerHTML = err.toString();\n    var messages = document.getElementById('messages');\n    var message = document.createElement('div');\n    message.className = 'alert alert-danger message';\n    message.appendChild(button);\n    message.appendChild(text);\n    button.addEventListener('click', function() {\n        messages.removeChild(message);\n    }, false);\n    messages.appendChild(message);\n    if (err instanceof Error) {\n        console.error(err.stack);\n    }\n};\n",
    "\nvar api = require('../api');\nvar view = require('../view');\nvar resolveObject = require('../resolve_object');\nvar comments_item = require('../vm/comments_item');\n\nvar template = \"<h2 data-bind=\\\"text: title\\\"></h2>\\n<h3>Comments</h3>\\n<ul data-bind=\\\"foreach: comments\\\" class=\\\"list-group\\\">\\n    <li data-bind=\\\"style: { 'padding-left': (15 * (depth + 1)) + 'px' }\\\"\\n        class=\\\"list-group-item post-item\\\">\\n        <h4 data-bind=\\\"text: author\\\" class=\\\"list-group-item-heading\\\"></h4>\\n        <div class=\\\"list-group-item-text\\\">\\n            Date: <span data-bind=\\\"text: formatDate(date)\\\"></span>\\n            <div class=\\\"post-controls\\\">\\n                <div class=\\\"panel panel-default\\\">\\n                    <div data-bind=\\\"text: content\\\" class=\\\"panel-body\\\"></div>\\n                </div>\\n                <!-- ko if: removable -->\\n                    <a data-bind=\\\"click: remove\\\" class=\\\"btn btn-default btn-sm\\\" href=\\\"#\\\">\\n                        <span class=\\\"glyphicon glyphicon-remove\\\"></span> Remove\\n                    </a>\\n                <!-- /ko -->\\n            </div>\\n        </div>\\n    </li>\\n</ul>\\n<!-- ko if: comments().length === 0 -->\\n    <div class=\\\"alert alert-info\\\" role=\\\"alert\\\">\\n        This entry has no comments.\\n    </div>\\n<!-- /ko -->\\n\";\n\n// Page for the comments list.\nexports.create = function(type, id) {\n\n    var model = {\n        title: ko.observable(),\n        comments: ko.observable([])\n    };\n\n    var requests = {\n        entryInfo: api.entryInfo(id),\n        userInfo: api.userInfo(id),\n        typeInfo: api.typeInfo(type),\n        comments: api.comments(id)\n    };\n\n    function flatten(comments) {\n        var flat = [];\n        flattenRec(comments, flat, 0);\n        return flat;\n    }\n\n    function flattenRec(comments, list, depth) {\n        comments.forEach(function(comment) {\n            comment.depth = depth;\n            list.push(comment);\n            flattenRec(comment.replies, list, depth + 1);\n        });\n    }\n    \n    return resolveObject(requests).then(function(data) {\n        model.title(data.entryInfo.title);\n        model.comments(flatten(data.comments).map(function(comment) {\n            return comments_item.create(comment,\n                data.userInfo, data.entryInfo, data.typeInfo);\n        }));\n        view.show(template, model);\n    });\n};\n",
    "\nvar api = require('../api');\nvar view = require('../view');\nvar message = require('../message');\nvar resolveObject = require('../resolve_object');\n\nvar template = \"<h2>Configuration</h2>\\n<!-- ko if: !permission() -->\\n    <div class=\\\"alert alert-warning\\\" role=\\\"alert\\\">\\n        You do not have permissions to edit configuration.\\n    </div>\\n<!-- /ko -->\\n<!-- ko if: permission() -->\\n    <!-- ko with: config -->\\n        <div class=\\\"row\\\">\\n            <div class=\\\"col-md-2 col-sm-3 col-xs-4 text-right\\\">\\n                <strong>Site base URL</strong></div>\\n            <div data-bind=\\\"text: site\\\"\\n                class=\\\"col-md-4 col-sm-5 col-xs-8\\\"></div>\\n        </div>\\n        <div class=\\\"row\\\">\\n            <div class=\\\"col-md-2 col-sm-3 col-xs-4 text-right\\\">\\n                <strong>Title</strong></div>\\n            <div data-bind=\\\"text: title\\\"\\n                class=\\\"col-md-4 col-sm-5 col-xs-8\\\"></div>\\n        </div>\\n    <!-- /ko -->\\n    <div class=\\\"row bc-margin-top\\\">\\n        <div class=\\\"col-md-4 col-sm-5 col-xs-8 col-md-offset-2 col-sm-offset-3 col-xs-offset-4\\\">\\n            <a href=\\\"#\\\" data-bind=\\\"click: edit\\\" class=\\\"btn btn-default\\\">\\n                <span class=\\\"glyphicon glyphicon-pencil\\\"></span> Edit</a>\\n        </div>\\n    </div>\\n    <!-- ko if: editing() -->\\n        <hr>\\n        <form data-bind=\\\"submit: save\\\" autocomplete=\\\"off\\\" id=\\\"config-form\\\">\\n            <div data-bind=\\\"errors: errors.site\\\" class=\\\"form-group\\\">\\n                <label for=\\\"config-site\\\">Site base URL</label>\\n                <input data-bind=\\\"textInput: form.site\\\"\\n                    type=\\\"text\\\" class=\\\"form-control\\\" id=\\\"config-site\\\"\\n                    placeholder=\\\"Site base URL\\\">\\n            </div>\\n            <div class=\\\"form-group\\\">\\n                <label for=\\\"config-title\\\">Title</label>\\n                <input data-bind=\\\"textInput: form.title\\\"\\n                    type=\\\"text\\\" class=\\\"form-control\\\" id=\\\"config-title\\\"\\n                    placeholder=\\\"Site title\\\">\\n            </div>\\n            <button type=\\\"submit\\\" class=\\\"btn btn-default\\\">\\n                <span class=\\\"glyphicon glyphicon-ok\\\"></span> Save\\n            </button>\\n            <a data-bind=\\\"click: cancel\\\" class=\\\"btn btn-default\\\" href=\\\"#\\\">\\n                <span class=\\\"glyphicon glyphicon-remove\\\"></span> Cancel</a>\\n        </form>\\n    <!-- /ko -->\\n<!-- /ko -->\\n\";\n\n// Page for editing email settings.\nexports.create = function(id) {\n\n    var model = {\n        permission: ko.observable(false),\n        editing: ko.observable(false),\n        config: ko.observable({}),\n        form: {\n            site: ko.observable(''),\n            title: ko.observable('')\n        },\n        errors: {\n            site: ko.observableArray([]),\n            title: ko.observableArray([])\n        }\n    };\n\n    // Saves settings and updates the\n    // read-only views of options.\n    model.save = function(form) {\n        clearErrors();\n        validateParams();\n        // Checks whether some input\n        // has error set.\n        if (!checkError(form)) {\n            return false;\n        }\n        var config = toConfig(model.form);\n        api.updateConfig(toList(config)).then(function() {\n            model.config(config);\n            message.info('Configuration updated.');\n            route.refresh();\n        }).catch(message.error);\n    };\n\n    model.edit = function() {\n        model.editing(true);\n    };\n\n    // Cancels editing. Refreshes current page.\n    model.cancel = function() {\n        route.refresh();\n    };\n\n    // Clears current form errors.\n    function clearErrors() {\n        Object.keys(model.errors).forEach(function(key) {\n            model.errors[key]([]);\n        });\n    }\n\n    // Validates parameters.\n    function validateParams() {\n        var form = model.form;\n        if (form.site() === '') {\n            model.errors.site.push('Site base URL must be set.');\n        } else {\n            if (!form.site().match(/^https?:\\/\\//)) {\n                model.errors.site.push('Site base URL must start with http:// or https://.');\n            }\n            if (form.site().match(/\\/$/)) {\n                model.errors.site.push('Site base URL must not end with /.');\n            }\n        }\n    }\n\n    // Checks for errors on the form\n    // elements. Focuses on the first\n    // input with an error.\n    function checkError(form) {\n        var input = form.querySelector(\n            '.has-error input, .has-error textarea,' +\n            ' .has-error checkbox, .has-error select');\n        if (input) {\n            input.focus();\n            return false;\n        }\n        return true;\n    }\n\n    return api.userInfo().then(function(info) {\n        if (info.type !== 'admin') {\n            view.show(template, model);\n        } else {\n            return api.config().then(function(data) {\n                var config = extract(data);\n                model.config(config);\n                toForm(config, model.form);\n                model.permission(true);\n                view.show(template, model);\n            });\n        }\n    });\n};\n\n// Extracts supported config settings from\n// generic config entries.\nfunction extract(config) {\n    var obj = {};\n    config.forEach(function(entry) {\n        obj[entry.name] = entry.value;\n    });\n    return {\n        site: obj.site,\n        title: obj.title\n    };\n}\n\n// Sets form values based on\n// config values.\nfunction toForm(config, form) {\n    Object.keys(config).forEach(function(key) {\n        form[key](config[key]);\n    });\n}\n\n// Creates new object with\n// values from the form binding\n// object.\nfunction toConfig(form) {\n    var config = {};\n    Object.keys(form).forEach(function(key) {\n        config[key] = form[key]();\n    });\n    return config;\n}\n\n// Turns the configuration\n// object into a list of configuration\n// entries.\n\nfunction toList(config) {\n    return [\n        { name: 'site', value: config.site },\n        { name: 'title', value: config.title }\n    ];\n}\n",
    "\nvar api = require('../api');\nvar view = require('../view');\nvar message = require('../message');\nvar resolveObject = require('../resolve_object');\n\nvar template = \"<h2>Email settings</h2>\\n<!-- ko if: !permission() -->\\n    <div class=\\\"alert alert-warning\\\" role=\\\"alert\\\">\\n        You do not have permissions to edit email settings.\\n    </div>\\n<!-- /ko -->\\n<!-- ko if: permission() -->\\n    <!-- ko with: smtp -->\\n        <div class=\\\"row bc-margin-top\\\">\\n            <div class=\\\"col-md-2 col-sm-3 col-xs-4 text-right\\\">\\n                <strong>Enabled</strong></div>\\n            <div data-bind=\\\"text: (enabled ? 'yes' : 'no')\\\"\\n                class=\\\"col-md-4 col-sm-5 col-xs-8\\\"></div>\\n        </div>\\n        <div class=\\\"row\\\">\\n            <div class=\\\"col-md-2 col-sm-3 col-xs-4 text-right\\\">\\n                <strong>SMTP host</strong></div>\\n            <div data-bind=\\\"text: host\\\"\\n                class=\\\"col-md-4 col-sm-5 col-xs-8\\\"></div>\\n        </div>\\n        <div class=\\\"row\\\">\\n            <div class=\\\"col-md-2 col-sm-3 col-xs-4 text-right\\\">\\n                <strong>SMTP auth</strong></div>\\n            <div data-bind=\\\"text: auth\\\"\\n                class=\\\"col-md-4 col-sm-5 col-xs-8\\\"></div>\\n        </div>\\n        <!-- ko if: auth === 'login' -->\\n            <div class=\\\"row\\\">\\n                <div class=\\\"col-md-2 col-sm-3 col-xs-4 text-right\\\">\\n                    <strong>SMTP user</strong></div>\\n                <div data-bind=\\\"text: (user === '' ? 'not set' : user)\\\"\\n                    class=\\\"col-md-4 col-sm-5 col-xs-8\\\"></div>\\n            </div>\\n            <div class=\\\"row\\\">\\n                <div class=\\\"col-md-2 col-sm-3 col-xs-4 text-right\\\">\\n                    <strong>SMTP password</strong></div>\\n                <div data-bind=\\\"text: (password === '' ? 'not set' : 'not shown')\\\"\\n                    class=\\\"col-md-4 col-sm-5 col-xs-8\\\"></div>\\n            </div>\\n        <!-- /ko -->\\n        <div class=\\\"row\\\">\\n            <div class=\\\"col-md-2 col-sm-3 col-xs-4 text-right\\\">\\n                <strong>SMTP security</strong></div>\\n            <div data-bind=\\\"text: security\\\"\\n                class=\\\"col-md-4 col-sm-5 col-xs-8\\\"></div>\\n        </div>\\n        <div class=\\\"row\\\">\\n            <div class=\\\"col-md-2 col-sm-3 col-xs-4 text-right\\\">\\n                <strong>SMTP from</strong></div>\\n            <div data-bind=\\\"text: from\\\"\\n                class=\\\"col-md-4 col-sm-5 col-xs-8\\\"></div>\\n        </div>\\n    <!-- /ko -->\\n    <div class=\\\"row bc-margin-top\\\">\\n        <div class=\\\"col-md-4 col-sm-5 col-xs-8 col-md-offset-2 col-sm-offset-3 col-xs-offset-4\\\">\\n            <a href=\\\"#\\\" data-bind=\\\"click: edit\\\" class=\\\"btn btn-default\\\">\\n                <span class=\\\"glyphicon glyphicon-pencil\\\"></span> Edit</a>\\n        </div>\\n    </div>\\n    <!-- ko if: editing() -->\\n        <hr>\\n        <form data-bind=\\\"submit: save\\\" autocomplete=\\\"off\\\" id=\\\"smtp-config\\\">\\n            <div class=\\\"checkbox\\\">\\n                <label><input data-bind=\\\"checked: form.enabled\\\" type=\\\"checkbox\\\">\\n                    Mail system enabled</label>\\n            </div>\\n            <div data-bind=\\\"errors: errors.host\\\" class=\\\"form-group\\\">\\n                <label for=\\\"smtp-host\\\">SMTP host</label>\\n                <input data-bind=\\\"textInput: form.host\\\"\\n                    type=\\\"text\\\" class=\\\"form-control\\\" id=\\\"smtp-host\\\"\\n                    placeholder=\\\"SMTP server hostname\\\">\\n            </div>\\n            <div class=\\\"form-group\\\">\\n                <label for=\\\"smtp-auth\\\">SMTP authentication method</label>\\n                <select data-bind=\\\"value: form.auth\\\" id=\\\"smtp-auth\\\"\\n                    class=\\\"form-control\\\">\\n                    <option value=\\\"plain\\\">Plain</option>\\n                    <option value=\\\"login\\\">Login</option>\\n                </select>\\n            </div>\\n            <div data-bind=\\\"errors: errors.user\\\" class=\\\"form-group\\\">\\n                <label for=\\\"smtp-user\\\">SMTP user</label>\\n                <input data-bind=\\\"textInput: form.user,\\n                        disable: form.auth() === 'plain'\\\"\\n                    type=\\\"text\\\" class=\\\"form-control\\\" id=\\\"smtp-user\\\"\\n                    placeholder=\\\"SMTP server user\\\">\\n            </div>\\n            <div data-bind=\\\"errors: errors.password\\\" class=\\\"form-group\\\">\\n                <label for=\\\"smtp-password\\\">SMTP password</label>\\n                <input data-bind=\\\"textInput: form.password,\\n                        disable: form.auth() === 'plain',\\n                        attr: { type: password_text() ? 'text' : 'password' }\\\"\\n                    type=\\\"password\\\" class=\\\"form-control\\\" id=\\\"smtp-password\\\"\\n                    placeholder=\\\"SMTP server password\\\">\\n            </div>\\n            <div class=\\\"checkbox\\\">\\n                <label><input data-bind=\\\"checked: password_text\\\" type=\\\"checkbox\\\">\\n                    Show text</label>\\n            </div>\\n            <div class=\\\"form-group\\\">\\n                <label for=\\\"smtp-security\\\">SMTP security</label>\\n                <select data-bind=\\\"value: form.security\\\" id=\\\"smtp-security\\\"\\n                    class=\\\"form-control\\\">\\n                    <option value=\\\"none\\\">None</option>\\n                    <option value=\\\"ssl\\\">SSL</option>\\n                    <option value=\\\"tls\\\">TLS</option>\\n                    <option value=\\\"starttls\\\">STARTTLS</option>\\n                </select>\\n            </div>\\n            <div data-bind=\\\"errors: errors.from\\\" class=\\\"form-group\\\">\\n                <label for=\\\"smtp-from\\\">Notification sender email (From)</label>\\n                <input data-bind=\\\"textInput: form.from\\\"\\n                    type=\\\"text\\\" class=\\\"form-control\\\" id=\\\"smtp-form\\\"\\n                    placeholder=\\\"Mail sender address\\\">\\n            </div>\\n            <div class=\\\"alert alert-info\\\" role=\\\"alert\\\">\\n                New SMTP settings should be tested before saving. The\\n                test email will be sent to the current user's mail address.\\n            </div>\\n            <!-- ko if: !!error() -->\\n                <div data-bind=\\\"text: error\\\" class=\\\"alert alert-danger\\\" role=\\\"alert\\\"></div>\\n            <!-- /ko -->\\n            <!-- ko if: !!info() -->\\n                <div data-bind=\\\"text: info\\\" class=\\\"alert alert-success\\\" role=\\\"alert\\\"></div>\\n            <!-- /ko -->\\n            <div data-bind=\\\"errors: errors.subject\\\" class=\\\"form-group\\\">\\n                <label for=\\\"smtp-subject\\\">Test mail subject</label>\\n                <input data-bind=\\\"textInput: form.subject\\\"\\n                    type=\\\"text\\\" class=\\\"form-control\\\" id=\\\"smtp-subject\\\"\\n                    placeholder=\\\"Test mail subject\\\">\\n            </div>\\n            <div data-bind=\\\"errors: errors.body\\\" class=\\\"form-group\\\">\\n                <label for=\\\"smtp-body\\\">Test mail body</label>\\n                <textarea data-bind=\\\"textInput: form.body\\\"\\n                    placeholder=\\\"Test mail body\\\" rows=\\\"3\\\"\\n                    class=\\\"form-control\\\" id=\\\"smtp-body\\\"></textarea>\\n            </div>\\n            <button type=\\\"submit\\\" class=\\\"btn btn-default\\\">\\n                <span class=\\\"glyphicon glyphicon-ok\\\"></span> Save\\n            </button>\\n            <a data-bind=\\\"click: test\\\" class=\\\"btn btn-default\\\" href=\\\"#\\\">\\n                <span class=\\\"glyphicon glyphicon-envelope\\\"></span> Test</a>\\n            <a data-bind=\\\"click: cancel\\\" class=\\\"btn btn-default\\\" href=\\\"#\\\">\\n                <span class=\\\"glyphicon glyphicon-remove\\\"></span> Cancel</a>\\n        </form>\\n    <!-- /ko -->\\n<!-- /ko -->\\n\";\n\n// Page for editing email settings.\nexports.create = function(id) {\n\n    var model = {\n        email: ko.observable(),\n        permission: ko.observable(false),\n        editing: ko.observable(false),\n        smtp: ko.observable({}),\n        form: {\n            enabled: ko.observable(false),\n            host: ko.observable(''),\n            user: ko.observable(''),\n            password: ko.observable(''),\n            auth: ko.observable('login'),\n            security: ko.observable('none'),\n            from: ko.observable('admin@example.com'),\n            subject: ko.observable('Test mail'),\n            body: ko.observable('Test mail body')\n        },\n        errors: {\n            host: ko.observableArray([]),\n            user: ko.observableArray([]),\n            password: ko.observableArray([]),\n            from: ko.observableArray([]),\n            subject: ko.observableArray([]),\n            body: ko.observableArray([])\n        },\n        // Test error.\n        error: ko.observable(),\n        // Test info message.\n        info: ko.observable(),\n        // Flag to show password unmasked.\n        password_text: ko.observable(false)\n    };\n\n    // Saves settings and updates the\n    // read-only views of options.\n    model.save = function(form) {\n        clearErrors();\n        validateParams();\n        // Checks whether some input\n        // has error set.\n        if (!checkError(form)) {\n            return false;\n        }\n        var smtp = toSmtp(model.form);\n        api.updateConfig(toList(smtp)).then(function() {\n            model.smtp(smtp);\n            message.info('Mailing system parameters have been updated.');\n            route.refresh();\n        }).catch(message.error);\n    };\n\n    model.edit = function() {\n        model.editing(true);\n    };\n\n    // Tests the settings that are currently\n    // set in the editing form.\n    model.test = function() {\n        model.info(undefined);\n        model.error(undefined);\n        clearErrors();\n        validateParams();\n        validateTest();\n        var form = document.getElementById('smtp-config');\n        // Checks whether some input\n        // has error set.\n        if (!checkError(form)) {\n            return false;\n        }\n        var smtp = toSmtp(model.form);\n        api.testMail(smtp).then(function() {\n            model.info('Test mail sent successfully.');\n        }).catch(function(err) {\n            model.error('Mail testing failed: ' +\n                (err.jsendMessage ? err.jsendMessage : err.toString()));\n        });\n    };\n\n    // Cancels editing. Refreshes current page.\n    model.cancel = function() {\n        route.refresh();\n    };\n\n    // Clears current form errors.\n    function clearErrors() {\n        Object.keys(model.errors).forEach(function(key) {\n            model.errors[key]([]);\n        });\n    }\n\n    // Validates SMTP parameters.\n    function validateParams() {\n        var form = model.form;\n        if (form.host().match(/^\\s*$/)) {\n            model.errors.host.push('SMTP host name must be set.');\n        }\n        if (form.auth() === 'login') {\n            if (form.user().match(/^\\s*$/)) {\n                model.errors.user.push('SMTP user must be set for SMTP auth.');\n            }\n            if (form.password().match(/^\\s*$/)) {\n                model.errors.password.push('SMTP password must be set for SMTP auth.');\n            }\n        }\n        if (form.from().match(/^\\s*$/)) {\n            model.errors.from.push('Notification sender mail must be set.');\n        } else {\n            if (!form.from().match(/^[^@]+@[^@]+$/)) {\n                model.errors.from.push('Notification sender mail must be a valid mail address.');\n            }\n        }\n    }\n\n    // Validates test parameters.\n    function validateTest() {\n        var form = model.form;\n        if (form.subject().match(/^\\s*$/)) {\n            model.errors.subject.push('Test mail subject must be set.');\n        }\n        if (form.body().match(/^\\s*$/)) {\n            model.errors.body.push('Test mail body must be set.');\n        }\n    }\n\n    // Checks for errors on the form\n    // elements. Focuses on the first\n    // input with an error.\n    function checkError(form) {\n        var input = form.querySelector(\n            '.has-error input, .has-error textarea,' +\n            ' .has-error checkbox, .has-error select');\n        if (input) {\n            input.focus();\n            return false;\n        }\n        return true;\n    }\n\n    return api.userInfo().then(function(info) {\n        if (info.type !== 'admin') {\n            view.show(template, model);\n        } else {\n            return api.config().then(function(config) {\n                var smtp = extract(config);\n                model.smtp(smtp);\n                toForm(smtp, model.form);\n                model.permission(true);\n                view.show(template, model);\n            });\n        }\n    });\n};\n\n// Extracts SMTP settings from\n// generic config entries.\nfunction extract(config) {\n    var obj = {};\n    config.forEach(function(entry) {\n        obj[entry.name] = entry.value;\n    });\n    return {\n        enabled: obj.smtp_enabled,\n        host: obj.smtp_host,\n        user: obj.smtp_user,\n        password: obj.smtp_password,\n        auth: obj.smtp_auth,\n        security: obj.smtp_security,\n        from: obj.smtp_from\n    };\n}\n\n// Sets form values based on\n// smtp values.\nfunction toForm(smtp, form) {\n    Object.keys(smtp).forEach(function(key) {\n        form[key](smtp[key]);\n    });\n}\n\n// Creates new object with\n// values from the form binding\n// object.\nfunction toSmtp(form) {\n    var smtp = {};\n    Object.keys(form).forEach(function(key) {\n        smtp[key] = form[key]();\n    });\n    return smtp;\n}\n\n// Turns the SMTP configuration\n// object into a list of configuration\n// entries.\nfunction toList(smtp) {\n    return [\n        { name: 'smtp_enabled', value: smtp.enabled },\n        { name: 'smtp_host', value: smtp.host },\n        { name: 'smtp_user', value: smtp.user },\n        { name: 'smtp_password', value: smtp.password },\n        { name: 'smtp_auth', value: smtp.auth },\n        { name: 'smtp_security', value: smtp.security },\n        { name: 'smtp_from', value: smtp.from }\n    ];\n}\n",
    "\nvar api = require('../api');\nvar view = require('../view');\nvar message = require('../message');\n\nvar template = \"<h2>Login</h2>\\n\\n<form data-bind=\\\"submit: login\\\">\\n    <div data-bind=\\\"errors: errors.username\\\" class=\\\"form-group\\\">\\n        <label class=\\\"control-label\\\" for=\\\"username\\\">Username</label>\\n        <input data-bind=\\\"textInput: username\\\"\\n            type=\\\"text\\\" name=\\\"username\\\" title=\\\"Username\\\"\\n            placeholder=\\\"Username\\\" class=\\\"form-control\\\" id=\\\"username\\\">\\n    </div>\\n    <div data-bind=\\\"errors: errors.password\\\" class=\\\"form-group\\\">\\n        <label class=\\\"control-label\\\" for=\\\"password\\\">Password</label>\\n        <input data-bind=\\\"textInput: password\\\"\\n            type=\\\"password\\\" name=\\\"password\\\" title=\\\"Password\\\"\\n            placeholder=\\\"Password\\\" class=\\\"form-control\\\" id=\\\"password\\\">\\n    </div>\\n    <div class=\\\"checkbox\\\">\\n        <label><input data-bind=\\\"checked: remember\\\" type=\\\"checkbox\\\"\\n            name=\\\"remember\\\" id=\\\"remember\\\">\\n            Remember me</label>\\n    </div>\\n    <button type=\\\"submit\\\" class=\\\"btn btn-default\\\">\\n        <span class=\\\"glyphicon glyphicon-log-in\\\"></span> Login</button>\\n</form>\\n\";\n\n// The login page.\nexports.create = function() {\n\n    var model = {\n        username: ko.observable(''),\n        password: ko.observable(''),\n        remember: ko.observable(false),\n        errors: {\n            username: ko.observableArray([]),\n            password: ko.observableArray([])\n        }\n    };\n\n    model.login = function(form) {\n        // Clear errors.\n        Object.keys(model.errors).forEach(function(key) {\n            model.errors[key]([]);\n        });\n        var username = model.username();\n        var password = model.password();\n        if (username === '') {\n            model.errors.username.push('Username is not entered.');\n        } else if (!username.match(/^[^@]+@[^@]+$/)) {\n            model.errors.username.push('Username must be an email.');\n        }\n        if (password === '') {\n            model.errors.password.push('Password is not entered.');\n        }\n        var input = form.querySelector(\n            '.has-error input, .has-error textarea, .has-error checkbox');\n        if (input) {\n            input.focus();\n            return false;\n        }\n        api.login(username, password).then(function(res) {\n            if (model.remember()) {\n                localStorage.setItem('api-key', res.key);\n                sessionStorage.removeItem('api-key');\n            } else {\n                sessionStorage.setItem('api-key', res.key);\n                localStorage.removeItem('api-key');\n            }\n            route.go('landing');\n        }).catch(function(err) {\n            if (err.toString().match(/Invalid auth credentials/)) {\n                model.errors.username.push('Invalid auth credentials.');\n                model.errors.password.push('Invalid auth credentials.');\n            } else {\n                message.error(err);\n            }\n        });\n    };\n\n    view.show(template, model);\n    return Promise.resolve();\n};\n",
    "var api = require('../api');\nvar message = require('../message');\nvar languages = require('../languages');\nvar files_item = require('./files_item');\n\n// Creates post view model for already\n// existing post or a new post. For new\n// post, data must be unset. The authors\n// argument must contain the list of all\n// users.\nexports.create = function(userInfo, type, types, authors, files, data, recovered) {\n\n    var post = {\n        $id: ko.observable(),\n        // List of authors. Used by the\n        // author list dropdown.\n        authors: authors,\n        // The post title. When this is\n        // the new post then initial slug\n        // is generated by it.\n        title: ko.observable('Untitled'),\n        // The post slug. Can contain\n        // \"safe\" characters only.\n        slug: ko.observable('untitled'),\n        // The post description. Can\n        // be left blank.\n        description: ko.observable(''),\n        types: types,\n        // The post type. Currently\n        // available types are post,\n        // page and block.\n        type: ko.observable(type),\n        // Type of the post content.\n        // Will be processed by the\n        // Markdown formatter when set\n        // to 'markdown''\n        content_type: ko.observable('markdown'),\n        // Flag to set whether the post\n        // is published or not.\n        published: ko.observable(false),\n        // Flag to set whether commenting\n        // is allowed or not.\n        commenting: ko.observable(true),\n        // List of tags. Tags are separated\n        // by commas.\n        tags: ko.observable(''),\n        // The count of comments.\n        // Currently not used.\n        comments: ko.observable(0),\n        // Selected user. Only admins\n        // can select author other than\n        // themself.\n        author: ko.observable(),\n        // Publish date as a string in\n        // the format YYYY-MM-DD. Might be\n        // unset when published flag is not set.\n        date: ko.observable(''),\n        // Update date as a string in\n        // the format YYYY-MM-DD.\n        update: ko.observable(''),\n        // Validates the post data.\n        // Saves or updates it using the API.\n        submit: function() {\n            submitPost(post, 'edit');\n        },\n        // Similar to submit but leaves\n        // the form.\n        save: function() {\n            submitPost(post, 'leave');\n        },\n        // The post language code. See\n        // languages.js for the list of codes.\n        language: ko.observable(bcLanguage),\n        // List of available languages.\n        languages: languages,\n        // Indicator for files component.\n        slug_changed: ko.observable(false),\n        // Only admin can change the type.\n        can_change_type: userInfo.type === 'admin',\n        // Only admin can change the author.\n        can_change_author: userInfo.type === 'admin',\n        // Array of entry files.\n        files: ko.observableArray(files),\n        // Input errors for the errors\n        // binding.\n        errors: {\n            title: ko.observableArray([]),\n            slug: ko.observableArray([]),\n            content: ko.observableArray([]),\n            date: ko.observableArray([]),\n            update: ko.observableArray([])\n        },\n\n        // Returns the plain data object\n        // to send to the backend.\n        toJS: function() {\n            var tags = post.tags().trim();\n            var date = post.date();\n            // date_published will be undefined when\n            // no date has been entered.\n            var date_published;\n            if (date !== '') {\n                date_published = isoDateToUnix(date);\n            }\n            var date_updated = isoDateToUnix(post.update());\n            return {\n                author: post.author(),\n                title: post.title(),\n                slug: post.slug(),\n                description: post.description(),\n                content: post.editor.content(),\n                type: post.type(),\n                date_published: date_published,\n                date_updated: date_updated,\n                commenting: post.commenting(),\n                published: post.published(),\n                content_type: post.content_type(),\n                tags: tags === '' ? [] : tags.split(/\\, */),\n                language: post.language()\n            };\n        },\n\n        // Updates values from a plain\n        // data object.\n        fromJS: function(data) {\n            // When the publish date is set then\n            // set the date field to formatted string.\n            if (typeof data.date_published !== 'undefined') {\n                var d = new Date(data.date_published * 1000);\n                post.date(d.toISOString().substring(0, 10));\n            }\n            post.$id(data.$id);\n            post.author(data.author);\n            post.title(data.title);\n            post.slug(data.slug);\n            post.description(data.description || '');\n            post.type(data.type);\n            post.content_type(data.content_type);\n            post.published(data.published);\n            post.commenting(data.commenting);\n            post.tags(data.tags.join(', '));\n            post.comments(data.comments);\n            post.language(data.language);\n            // Set up the existing files list.\n            files.sort(function(left, right) {\n                return left.name === right.name ? 0 : (left.name < right.name ? -1 : 1);\n            });\n            post.files(files.map(function(file) {\n                return files_item.create(post.slug, file);\n            }));\n        }\n    };\n\n    var typeInfo;\n    types.forEach(function(info) {\n        if (info.name === type) {\n            typeInfo = info;\n        }\n    });\n    if (!typeInfo) {\n        throw new Error('Invalid type ' + type);\n    }\n\n    // Use the preview URL pattern from\n    // type info.\n    post.preview = typeInfo.preview;\n\n    // Sets the view model values by the\n    // actual data object.\n    if (data) {\n        // Uses recovered data when set.\n        if (recovered) {\n            post.fromJS(recovered);\n            // Creates autosave from current state immediately.\n            setTimeout(function() {\n                post.parent.autosave();\n            }, 100);\n        } else {\n            post.fromJS(data);\n        }\n    } else {\n        // Uses recovered data.\n        if (recovered) {\n            post.fromJS(recovered);\n            // Creates autosave from current state immediately.\n            setTimeout(function() {\n                post.parent.autosave();\n            }, 100);\n        }\n        // Only when for new post.\n        // Add automatic slug generation.\n        post.title.subscribe(function(value) {\n            post.slug(getSlug(value));\n        });\n        // Select user as post author.\n        post.author(userInfo.$id);\n        // Default publish date.\n        post.date(new Date().toISOString().substring(0, 10));\n    }\n\n    // Set publishing permission flag.\n    post.can_publish = false;\n    if (userInfo.type === 'admin') {\n        post.can_publish = true;\n    }\n    if (typeInfo.grants.indexOf('publish_any') >= 0) {\n        post.can_publish = true;\n    }\n    if (typeInfo.grants.indexOf('publish_own') >= 0) {\n        if (post.author() === userInfo.$id) {\n            post.can_publish = true;\n        }\n    }\n\n    // Sets file management flag.\n    post.can_manage_files = false;\n    if (userInfo.type === 'admin') {\n        post.can_manage_files = true;\n    }\n    if (typeInfo.grants.indexOf('update_any') >= 0) {\n        if (typeInfo.grants.indexOf('files') >= 0) {\n            post.can_manage_files = true;\n        }\n    }\n    if (typeInfo.grants.indexOf('update_own') >= 0) {\n        if (post.author() === userInfo.$id) {\n            if (typeInfo.grants.indexOf('files') >= 0) {\n                post.can_manage_files = true;\n            }\n        }\n    }\n\n    // Default update date is the current date.\n    post.update(new Date().toISOString().substring(0, 10));\n\n    post.published.subscribe(function(value) {\n        // Set publish date when post is published.\n        // Applies only when no publish date is set.\n        if (value && post.date() === '') {\n            post.date(new Date().toISOString().substring(0, 10));\n        }\n    });\n\n    // Indicated that slug has been changed\n    // and file management does not work before\n    // saving.\n    post.slug.subscribe(function(value) {\n        post.slug_changed(true);\n    });\n\n    // Submits the file upload form and\n    // performs the file upload process.\n    post.uploadFile = function() {\n        var file = document.getElementById('entry-file').files[0];\n        if (!file || !post.$id()) {\n            return;\n        }\n        api.upload(post.$id(), file).then(function(response) {\n            message.info('File \"' + file.name + '\" has been uploaded.');\n            post.files.push(files_item.create(post.slug, { name: file.name }));\n            // This resets the file input.\n            var wrap = document.getElementById('entry-file-wrap');\n            wrap.innerHTML = '';\n            wrap.innerHTML = '<input type=\"file\" id=\"entry-file\" class=\"form-control\" placeholder=\"Your file\">';\n        }).catch(message.error);\n    };\n\n    // Removes the file.\n    // Asks confirmation.\n    post.removeFile = function(file) {\n        if (confirm('Remove the file \"' + file.name + '\"?')) {\n            api.removeFile(post.$id(), file.name).then(function() {\n                message.info('File \"' + file.name + '\" has been removed.');\n                post.files.remove(file);\n            }).catch(message.error);\n        }\n    };\n\n    // Adds as image.\n    post.insertImage = function(file) {\n        api.imageSize(post.$id(), file.name).then(function(size) {\n            post.editor.insert('<img src=\"' + file.url() +\n                '\" width=\"' +size.width + '\" height=\"' + size.height + '\">');\n            post.editor.focus();\n        }, function() {\n            // Ignores dimensions API error.\n            post.editor.insert('<img src=\"' + file.url() + '\">');\n            post.editor.focus();\n        }).catch(message.error);\n    };\n\n    // Adds as link.\n    post.insertLink = function(file) {\n        post.editor.insert('[' + file.name + '](' + file.url() + ')');\n        post.editor.focus();\n    };\n\n    // FIXME refactor\n    post.submitUpdate = function() {\n        return submitPost(post, 'edit');\n    };\n\n    // Sets change callback.\n    post.change = function(callback) {\n        post.changeCallback = callback;\n    };\n\n    // Set up change detection.\n\n    ['author', 'title', 'slug', 'description', 'type',\n        'content_type', 'published', 'commenting', 'tags',\n        'language', 'date', 'update'].forEach(function(input) {\n\n        post[input].subscribe(function() {\n            if (typeof post.changeCallback === 'function') {\n                post.changeCallback();\n            }\n        });\n    });\n\n    return post;\n};\n\n// Converts ISO8601 date part into\n// an Unix timestamp.\nfunction isoDateToUnix(string) {\n    var match = string.match(/^(\\d{4})\\-(\\d{2})\\-(\\d{2})$/);\n    if (!match) {\n        throw new Error('Date does not match pattern: ' + string);\n    }\n    var date = new Date();\n    date.setUTCHours(0, 0, 0, 0);\n    date.setUTCFullYear(parseInt(match[1], 10), parseInt(match[2], 10) - 1, parseInt(match[3], 10));\n    return Math.floor(date.getTime() / 1000);\n}\n\n// Validates the given post.\n// Adds errors using the validate module.\nfunction validatePost(post) {\n    if (post.title() === '') {\n        post.errors.title.push('Title is not entered.');\n    }\n    var slug = post.slug();\n    if (slug === '') {\n        post.errors.slug.push('Slug is not entered.');\n    } else {\n        if (!slug.match(/^[a-z0-9\\-_]+$/)) {\n            post.errors.slug.push('Use lowercase letters, numbers, hyphen and underscore.');\n        }\n    }\n    var date = post.date();\n    if (date === '') {\n        if (post.published()) {\n            post.errors.date.push('Publish date is not entered.');\n        }\n    } else if (!date.match(/^\\d{4}\\-\\d{2}\\-\\d{2}$/)) {\n        post.errors.date.push('Date must be in the YYYY-MM-DD format.');\n    }\n    var update = post.update();\n    if (update === '') {\n        post.errors.update.push('Update date is not entered.');\n    } else if (!update.match(/^\\d{4}\\-\\d{2}\\-\\d{2}$/)) {\n        post.errors.update.push('Update date must be in the YYYY-MM-DD format.');\n    }\n}\n\n// Handles save and\n// save-with-continue actions.\nfunction submitPost(post, action) {\n    var form = document.getElementById('post');\n    // Clear errors.\n    Object.keys(post.errors).forEach(function(key) {\n        post.errors[key]([]);\n    });\n    validatePost(post);\n    var input = form.querySelector(\n        '.has-error input, .has-error textarea, .has-error checkbox');\n    if (input) {\n        // Open the info section when\n        // it contains errors.\n        if (form.querySelector('.bc-info .has-error input,' +\n            ' .bc-info .has-error textarea, .bc-info .has-error checkbox')) {\n            post.parent.info(true);\n        }\n        input.focus();\n        return Promise.resolve(false);\n    }\n\n    // When post has '$id' property\n    // then it's an existing post.\n    if (post.$id()) {\n        return updatePost(form, post, action);\n    } else {\n        return savePost(form, post, action);\n    }\n}\n\n// Updates the already existing\n// post. Assumes that the post\n// is validated.\nfunction updatePost(form, post, action) {\n    return api.updatePost(post.$id(), post.toJS()).then(function() {\n        message.info('The entry \"' + post.title() + '\" has been updated.');\n        // Clear autosave.\n        post.parent.clearAutosave();\n        if (action === 'edit') {\n            post.slug_changed(false);\n            // Reload possibly changed post content.\n            api.post(post.$id()).then(function(data) {\n                if (post.editor.content() !== data.content) {\n                    post.editor.begin(data.content);\n                }\n                post.parent.modified(false);\n            }).catch(message.error);\n        } else {\n            route.go('entries/' + post.type());\n        }\n    }).catch(saveError.bind(null, post));\n}\n\n// Saves the new post.\nfunction savePost(form, post, action) {\n    return api.savePost(post.toJS()).then(function(res) {\n        message.info('The entry \"' + post.title() + '\" has been saved.');\n        post.parent.modified(false);\n        // Clear autosave.\n        post.parent.clearAutosave();\n        // Redirect to post page when we\n        // want to keep editing the post.\n        // Otherwise go back to listing page.\n        if (action === 'edit') {\n            route.go('entry/' + post.type() + '/' + res);\n        } else {\n            route.go('entries/' + post.type());\n        }\n    }).catch(saveError.bind(null, post));\n}\n\nfunction saveError(post, err) {\n    if (err.toString().match(/entry with the same slug exists/)) {\n        post.errors.slug.push('Entry with the same slug exists.');\n        // Open info section.\n        post.parent.info(true);\n        document.querySelector('.has-error input').focus();\n    } else {\n        message.error(err);\n    }\n    throw err;\n}\n",
    "\nvar api = require('../api');\nvar view = require('../view');\nvar postsItem = require('../vm/posts_item');\nvar resolveObject = require('../resolve_object');\n\nvar template = \"<h2 data-bind=\\\"text: title\\\"></h2>\\n\\n<div class=\\\"bc-margin-bottom\\\">\\n    <div class=\\\"row\\\">\\n        <div class=\\\"col-md-2\\\">\\n            <div class=\\\"form-group\\\">\\n                <label for=\\\"filter-tag\\\">Tag filter</label>\\n                <select data-bind=\\\"value: tag, options: tags,\\n                    optionsText: 'label', optionsValue: 'tag',\\n                    optionsCaption: 'All tags'\\\"\\n                    class=\\\"form-control input-sm\\\"></select>\\n            </div>\\n        </div>\\n        <div class=\\\"col-md-2\\\">\\n            <div class=\\\"form-group\\\">\\n                <label for=\\\"filter-status\\\">Status filter</label>\\n                <select data-bind=\\\"value: status\\\"\\n                    class=\\\"form-control input-sm\\\">\\n                    <option value=\\\"all\\\">All</option>\\n                    <option value=\\\"published\\\">Published</option>\\n                    <option value=\\\"unpublished\\\">Not published</option>\\n                </select>\\n            </div>\\n        </div>\\n    </div>\\n</div>\\n\\n<ul data-bind=\\\"foreach: posts\\\" class=\\\"list-group\\\">\\n    <li class=\\\"list-group-item post-item\\\">\\n        <h4 data-bind=\\\"click: expand, text: title\\\" class=\\\"list-group-item-heading\\\"></h4>\\n        <div class=\\\"list-group-item-text\\\">\\n            Update date: <span data-bind=\\\"text: formatDate(date_updated)\\\"></span>\\n            <!-- ko if: $parent.comments() -->\\n                comments: <span data-bind=\\\"text: comments\\\"></span><br>\\n            <!-- /ko -->\\n            <!-- ko if: tags.length > 0 -->\\n                <span data-bind=\\\"text: tags.join(', ')\\\" class=\\\"bc-entries-tag\\\"></span>\\n            <!-- /ko -->\\n            <div data-bind=\\\"visible: expanded\\\" class=\\\"post-controls bc-margin-bottom-sm\\\">\\n                <!-- ko if: editable -->\\n                    <a data-bind=\\\"attr: { href: editLink }\\\" class=\\\"btn btn-default btn-sm\\\" href=\\\"#\\\">\\n                        <span class=\\\"glyphicon glyphicon-edit\\\"></span> Edit\\n                    </a>\\n                <!-- /ko -->\\n                <!-- ko if: $parent.comments() -->\\n                    <a data-bind=\\\"attr: { href: commentsLink }, css: { disabled: comments === 0 }\\\"\\n                        class=\\\"btn btn-default btn-sm\\\" href=\\\"#\\\">\\n                        <span class=\\\"glyphicon glyphicon-comment\\\"></span> Comments\\n                    </a>\\n                <!-- /ko -->\\n                <!-- ko if: removable -->\\n                    <a data-bind=\\\"click: remove\\\"\\n                        class=\\\"btn btn-default btn-sm\\\" href=\\\"#\\\">\\n                        <span class=\\\"glyphicon glyphicon-remove\\\"></span> Remove\\n                    </a>\\n                <!-- /ko -->\\n            </div>\\n            <!-- ko if: !published -->\\n                <div>\\n                    <span class=\\\"label label-warning\\\">Not published</span>\\n                </div>\\n            <!-- /ko -->\\n        </div>\\n    </li>\\n</ul>\\n\\n<!-- ko if: posts().length === 0 -->\\n    <div class=\\\"alert alert-info\\\" role=\\\"alert\\\">\\n        No entries to show.\\n    </div>\\n<!-- /ko -->\\n\\n<div class=\\\"bc-controls\\\">\\n    <a data-bind=\\\"click: showMore, css: { disabled: !hasMore() }\\\" class=\\\"btn btn-default\\\" href=\\\"#\\\">\\n        <span class=\\\"glyphicon glyphicon-list-alt\\\"></span> Show more\\n    </a>\\n    <a data-bind=\\\"click: showAll, css: { disabled: !hasMore() }\\\" class=\\\"btn btn-default\\\" href=\\\"#\\\">\\n        <span class=\\\"glyphicon glyphicon-list-alt\\\"></span> Show all\\n    </a>\\n    <a data-bind=\\\"attr: { href: '#new/' + type }\\\" class=\\\"btn btn-default\\\" href=\\\"#\\\">\\n        <span class=\\\"glyphicon glyphicon-plus\\\"></span> Add\\n    </a>\\n</div>\\n\";\n\n// Page for displaying a post list.\nexports.create = function(type) {\n\n    var model = {\n        type: type,\n        all: ko.observable([]),\n        count: ko.observable(10),\n        step: ko.observable(10),\n        comments: ko.observable(false),\n        create: ko.observable(false),\n        title: ko.observable(),\n        loaded: ko.observable(false),\n        tags: ko.observable([]),\n        tag: ko.observable(),\n        status: ko.observable('all')\n    };\n\n    // List of filtered posts.\n    model.filtered = ko.pureComputed(function() {\n        var tag = model.tag();\n        var status = model.status();\n        var filtered = [];\n        model.all().forEach(function(entry) {\n            var tagMatch = !tag || entry.tags.indexOf(tag) > -1;\n            var statusMatch = status === 'all' || (\n                status === 'published' && entry.published) || (\n                status === 'unpublished' && !entry.published);\n            if (tagMatch && statusMatch) {\n                filtered.push(entry);\n            }\n        });\n        return filtered;\n    });\n\n    // Shows whether there are more\n    // pager pages.\n    model.hasMore = ko.pureComputed(function() {\n        return model.count() < model.filtered().length;\n    });\n\n    // Shows new pager page with posts.\n    model.showMore = function() {\n        model.count(model.count() + model.step());\n        setTimeout(function() {\n            // Scrolls to the bottom.\n            window.scrollTo(0, document.body.scrollHeight);\n        }, 50);\n    };\n\n    // Shows all posts.\n    model.showAll = function() {\n        model.count(model.filtered().length);\n    };\n\n    // Posts array considering the current\n    // pager state.\n    model.posts = ko.pureComputed(function() {\n        var all = model.filtered();\n        return all.slice(0, model.count());\n    });\n\n    // Finds data from API and updates\n    // the view.\n    var requests = {\n        typeInfo: api.typeInfo(type),\n        userInfo: api.userInfo(),\n        posts: api.posts(type),\n        tags: api.tags(type)\n    };\n\n    return resolveObject(requests).then(function(data) {\n        model.title(data.typeInfo.menu_label);\n        model.comments(data.typeInfo.comments);\n        var create = false;\n        // Finds if the user can create entries.\n        if (data.userInfo.type === 'admin') {\n            create = true;\n        }\n        if (data.typeInfo.grants.indexOf('create') >= 0) {\n            create = true;\n        }\n        model.create(create);\n        data.tags.forEach(function(tag) {\n            tag.label = tag.tag + ' (' + tag.count + ')';\n        });\n        data.tags.sort(function(t1, t2) {\n            return t1.tag === t2.tag ? 0 : (t1.tag < t2.tag ? -1 : 1);\n        });\n        model.tags(data.tags);\n        data.posts.sort(function(post1, post2) {\n            return post2.date_updated - post1.date_updated;\n        });\n        model.all(data.posts.map(function(postData) {\n            return postsItem.create(postData, data.typeInfo, data.userInfo);\n\n        }));\n        view.show(template, model);\n    });\n};\n",
    "\nvar api = require('../api');\nvar view = require('../view');\nvar message = require('../message');\nvar trash_item = require('../vm/trash_item');\n\nvar template = \"<h2>Trash</h2>\\n<!-- ko if: items().length === 0 -->\\n    <div class=\\\"alert alert-info\\\" role=\\\"alert\\\">\\n        Trash has no entries.\\n    </div>\\n<!-- /ko -->\\n<ul data-bind=\\\"foreach: items\\\" class=\\\"list-group\\\">\\n    <li class=\\\"list-group-item post-item\\\">\\n        <h4 data-bind=\\\"click: expand, text: title\\\" class=\\\"list-group-item-heading\\\"></h4>\\n        <div class=\\\"list-group-item-text\\\">\\n            Type: <span data-bind=\\\"text: type\\\"></span>\\n            <div data-bind=\\\"visible: expanded\\\" class=\\\"post-controls\\\">\\n                <a data-bind=\\\"click: remove\\\" class=\\\"btn btn-default btn-sm\\\" href=\\\"#\\\">\\n                    <span class=\\\"glyphicon glyphicon-remove\\\"></span> Remove\\n                </a>\\n                <a data-bind=\\\"click: restore\\\" class=\\\"btn btn-default btn-sm\\\" href=\\\"#\\\">\\n                    <span class=\\\"glyphicon glyphicon-floppy-disk\\\"></span> Restore\\n                </a>\\n            </div>\\n        </div>\\n    </li>\\n</ul>\\n<a data-bind=\\\"click: purge\\\" class=\\\"btn btn-default\\\" href=\\\"#\\\">\\n    <span class=\\\"glyphicon glyphicon-remove\\\"></span> Purge trash\\n</a>\\n\";\n\n// Page for displaying the trash list.\nexports.create = function() {\n\n    var model = {\n        items: ko.observableArray([])\n    };\n\n    model.purge = function() {\n        if (confirm('Purge trash?')) {\n            api.purge().then(function() {\n                message.info('Trash is purged.');\n                route.refresh();\n            }).catch(message.error);\n        }\n    };\n    \n    return api.trash().then(function(items) {\n        model.items(items.map(function(data) {\n            return trash_item.create(data);\n        }));\n        view.show(template, model);\n    });\n};\n",
    "var api = require('../api');\nvar message = require('../message');\n\nexports.create = function(roles, data) {\n\n    var user = {\n        username: ko.observable(''),\n        fullname: ko.observable(''),\n        type: ko.observable('author'),\n        link: ko.observable(''),\n        password: ko.observable(''),\n        password_edit: ko.observable(true),\n        password_text: ko.observable(false),\n        error: ko.observable(''),\n        creating: true,\n        roles: roles,\n        comment_notifications: ko.observable(false),\n        errors: {\n            username: ko.observableArray([]),\n            fullname: ko.observableArray([]),\n            password: ko.observableArray([]),\n            link: ko.observableArray([]),\n            type: ko.observableArray([])\n        },\n\n        save: function(form) {\n            // Clear errors.\n            Object.keys(user.errors).forEach(function(key) {\n                user.errors[key]([]);\n            });\n            if (user.password_edit()) {\n                var password = user.password();\n                if (password === '') {\n                    user.errors.password.push('Password is not set.');\n                } else if (password.length < 6) {\n                    user.errors.password.push('Password length must be at least 6.');\n                }\n            }\n            var username = user.username();\n            if (username === '') {\n                user.errors.username.push('Username is not set.');\n            } else {\n                if (!username.match(/^[^@]+@[^@]+$/)) {\n                    user.errors.username.push('Username must be an email address.');\n                }\n            }\n            var fullname = user.fullname();\n            if (fullname === '') {\n                user.errors.fullname.push('Full name is not set.');\n            }\n\n            var link = user.link();\n            if (link !== '') {\n                if (!link.match(/https?:\\/\\//)) {\n                    user.errors.link.push('Link must start with http:// or https:// prefix.');\n                }\n            }\n            var input = form.querySelector(\n                '.has-error input, .has-error textarea,' +\n                ' .has-error checkbox, .has-error select');\n            if (input) {\n                input.focus();\n                return false;\n            }\n            if (user.$id) {\n                api.updateUser(user.$id, user.toJS()).then(function() {\n                    message.info('User \"' + user.username() + '\" has been updated.');\n                    route.go('users');\n                }).catch(handleSaveError.bind(null, user));\n            } else {\n                api.saveUser(user.toJS()).then(function() {\n                    message.info('User \"' + user.username() + '\" has been added.');\n                    route.go('users');\n                }).catch(handleSaveError.bind(null, user));\n            }\n            return false;\n        },\n\n        toJS: function() {\n            var js = {\n                username: user.username(),\n                fullname: user.fullname(),\n                type: user.type(),\n                link: user.link(),\n                comment_notifications: user.comment_notifications()\n            };\n            if (user.password_edit()) {\n                js.password = user.password();\n            }\n            return js;\n        }\n    };\n\n    user.password_text.subscribe(function(value) {\n        if (value) {\n            document.getElementById('user-password').type = 'text';\n        } else {\n            document.getElementById('user-password').type = 'password';\n        }\n    });\n\n    if (data) {\n        user.$id = data.$id;\n        user.creating = false;\n        user.username(data.username);\n        user.fullname(data.fullname);\n        user.type(data.type);\n        user.link(data.link);\n        user.password_edit(false);\n        user.comment_notifications(data.comment_notifications);\n    } else {\n        user.fullname('Unnamed');\n    }\n\n    return user;\n};\n\nfunction handleSaveError(user, err) {\n    var string = err.toString();\n    if (string.match(/Cannot remove the last admin/)) {\n        user.errors.type.push('Cannot remove the last admin.');\n    } else if (string.match(/username exists/)) {\n        user.errors.username.push('The username exists.');\n    } else {\n        message.error(err);\n    }\n}\n",
    "\nvar api = require('../api');\nvar view = require('../view');\nvar users_item = require('../vm/users_item');\n\nvar template = \"<h2>Users</h2>\\n<!-- ko if: !permission() -->\\n    <div class=\\\"alert alert-warning\\\" role=\\\"alert\\\">\\n        You do not have permissions to manage users.\\n    </div>\\n<!-- /ko -->\\n<!-- ko if: permission() -->\\n    <ul data-bind=\\\"foreach: users\\\" class=\\\"list-group\\\">\\n        <li class=\\\"list-group-item post-item\\\">\\n            <h4 data-bind=\\\"click: expand, text: fullname\\\" class=\\\"list-group-item-heading\\\"></h4>\\n            <div class=\\\"list-group-item-text\\\">\\n                Type: <span data-bind=\\\"text: type\\\"></span>,\\n                username: <span data-bind=\\\"text: username\\\"></span>\\n                <div data-bind=\\\"visible: expanded\\\" class=\\\"post-controls\\\">\\n                    <a data-bind=\\\"attr: { href: '#user/' + $id }, css: { disabled: !editable }\\\"\\n                        class=\\\"btn btn-default btn-sm\\\" href=\\\"#\\\">\\n                        <span class=\\\"glyphicon glyphicon-edit\\\"></span> Edit\\n                    </a>\\n                    <a data-bind=\\\"click: remove, css: { disabled: !editable }\\\"\\n                        class=\\\"btn btn-default btn-sm\\\" href=\\\"#\\\">\\n                        <span class=\\\"glyphicon glyphicon-remove\\\"></span> Remove\\n                    </a>\\n                </div>\\n            </div>\\n        </li>\\n    </ul>\\n    <a class=\\\"btn btn-default\\\" href=\\\"#user/new\\\">\\n        <span class=\\\"glyphicon glyphicon-plus\\\"></span> Add\\n    </a>\\n<!-- /ko -->\\n\";\n\n// Page for displaying the users list.\nexports.create = function() {\n\n    var model = {\n        users: ko.observableArray([]),\n        permission: ko.observable(false)\n    };\n\n    return api.userInfo().then(function(info) {\n        if (info.type !== 'admin') {\n            view.show(template, model);\n        } else {\n            return api.users().then(function(users) {\n                model.users(users.map(function(data) {\n                    var user = users_item.create(data);\n                    user.editable = info.type === 'admin' || user.$id === info.$id;\n                    return user;\n                }));\n                model.permission(true);\n                view.show(template, model);\n            });\n        }\n    });\n};\n",
    "// Shows preview for the given URL.\nvar last, callback, editorScrollTop, viewScrollTop = -1;\n\n// Callback is called when preview is closed.\nexports.show = function(url, cb) {\n    var iframe = holder();\n    if (iframe) {\n        if (last === url) {\n            // Just refresh.\n            iframe.contentWindow.location.reload(true);\n        } else {\n            iframe.src = url;\n            viewScrollTop = -1;\n        }\n    } else {\n        iframe = document.createElement('iframe');\n        iframe.src = url;\n        preview.appendChild(iframe);\n        viewScrollTop = -1;\n    }\n    // Store scroll position.\n    editorScrollTop = document.body.scrollTop;\n    // Show preview.\n    main.style.display = 'none';\n    preview.style.display = 'block';\n    controls.style.display = 'block';\n    if (viewScrollTop > 0) {\n        // Restore preview scroll position when set.\n        document.body.scrollTop = viewScrollTop;\n    }\n    last = url;\n    callback = cb;\n};\n\nexports.dispose = function() {\n    // Clean preview element.\n    preview.innerHTML = '';\n    callback = null;\n};\n\nfunction holder() {\n    return preview.querySelector('iframe');\n}\n\n// Main and preview elements.\nvar main = document.getElementById('main');\nvar preview = document.getElementById('preview');\nvar controls = document.getElementById('preview-controls');\n\n// Control button to close the preview.\nvar close = controls.querySelector('[data-control=\"close\"]');\n\nclose.addEventListener('click', function(e) {\n    e.preventDefault();\n    hide();\n}, false);\n\n// Preview hide handler.\nfunction hideHandler(e) {\n    if (e.keyCode === 27) {\n        hide();\n    }\n}\n\nfunction hide() {\n    // Store preview scroll position.\n    viewScrollTop = document.body.scrollTop;\n    main.style.display = 'block';\n    preview.style.display = 'none';\n    controls.style.display = 'none';\n    if (typeof callback === 'function') {\n        callback();\n    }\n    // Restore editor scroll position.\n    document.body.scrollTop = editorScrollTop;\n}\n\ndocument.addEventListener('keydown', hideHandler, false);\n\n// Starts resize timer.\nvar timer;\nfunction resize() {\n    var iframe = holder();\n    if (iframe) {\n        var contentDocument = iframe.contentDocument;\n        if (contentDocument.body) {\n            var scrollHeight = contentDocument.body.scrollHeight;\n            var iframeHeight = iframe.clientHeight;\n            if (scrollHeight > iframeHeight) {\n                iframe.style.height = (scrollHeight + 50) + 'px';\n            }\n        }\n    }\n    timer = setTimeout(resize, 100);\n}\ntimer = resize();\n",
    "// Resolves object properties\n// as promises.\nmodule.exports = function(obj) {\n    var tasks = [], map = [];\n    Object.keys(obj).forEach(function(key) {\n        tasks.push(obj[key]);\n        map.push(key);\n    });\n    return Promise.all(tasks).then(function(data) {\n        var resolved = {};\n        data.forEach(function(value, i) {\n            resolved[map[i]] = value;\n        });\n        return resolved;\n    });\n};\n",
    "exports.show = function() {\n    document.getElementById('spinner').style.display = 'block';\n};\n\nexports.hide = function() {\n    document.getElementById('spinner').style.display = 'none';\n};\n",
    "exports.show = kontainer.create('#content');\n",
    "var api = require('../api');\nvar assign = require('../assign');\nvar message = require('../message');\n\n// View Model for a comment.\n\nexports.create = function(data, userInfo, entryInfo, typeInfo) {\n    var comment = {};\n    // Copies data attributes.\n    assign(comment, data);\n    comment.removable = false;\n    if (userInfo.type === 'admin') {\n        comment.removable = true;\n    }\n    if (typeInfo.grants.indexOf('update_any') >= 0) {\n        comment.removable = true;\n    }\n    if (typeInfo.grants.indexOf('update_own') >= 0) {\n        if (entryInfo.author === userInfo.$id) {\n            comment.removable = true;\n        }\n    }\n    comment.remove = function() {\n        if (confirm('Remove the comment?')) {\n            api.removeComment(entryInfo.$id, comment.$id).then(function() {\n                message.info('The comment has been removed.');\n                route.refresh();\n            }).catch(message.error);\n        }\n    };\n    return comment;\n};\n",
    "// Mixin for expandable view models.\nexports.mixin = function(obj) {\n    obj.expanded = ko.observable(false);\n    obj.expand = function() {\n        if (obj.expanded()) {\n            obj.expanded(false);\n        } else {\n            obj.expanded(true);\n        }\n    };\n};\n",
    "var api = require('../api');\nvar assign = require('../assign');\nvar message = require('../message');\nvar expandable = require('../vm/expandable');\n\n// Creates file view model for\n// the files list view.\nexports.create = function(slug, data) {\n    var file = {};\n    // Copies data attributes.\n    assign(file, data);\n    expandable.mixin(file);\n    file.url = ko.pureComputed(function() {\n        return '/' + encodeURIComponent(slug()) + '/' +\n            encodeURIComponent(file.name);\n    });\n    file.image = !!file.name.match(/\\.(gif|jpg|jpeg|tiff|png)$/i);\n    return file;\n};\n",
    "var api = require('../api');\nvar assign = require('../assign');\nvar message = require('../message');\nvar expandable = require('./expandable');\n\n// Creates posts view model for\n// the users list view.\n\nexports.create = function(data, typeInfo, userInfo) {\n\n    var post = {};\n\n    // Make it expandable.\n    expandable.mixin(post);\n\n    // Copies data attributes.\n    assign(post, data);\n\n    post.removable = false;\n\n    // Find if the entry can be removed.\n    if (userInfo.type === 'admin') {\n        post.removable = true;\n    }\n    if (typeInfo.grants.indexOf('remove_any') >= 0) {\n        post.removable = true;\n    }\n    if (typeInfo.grants.indexOf('remove_own') >= 0) {\n        if (userInfo.$id === post.author) {\n            post.removable = true;\n        }\n    }\n\n    post.editable = false;\n    if (userInfo.type === 'admin') {\n        post.editable = true;\n    }\n\n    if (typeInfo.grants.indexOf('update_any') >= 0) {\n        post.editable = true;\n    }\n\n    if (typeInfo.grants.indexOf('update_own') >= 0) {\n        if (userInfo.$id === post.author) {\n            post.editable = true;\n        }\n    }\n\n    post.editLink = '#entry/' + typeInfo.name + '/' + post.$id;\n    post.commentsLink = '#comments/' + typeInfo.name + '/' + post.$id;\n\n    // Removes the post.\n    // Asks confirmation.\n    post.remove = function() {\n        if (confirm('Remove the post \"' + post.title + '\"?')) {\n            api.removePost(post.$id).then(function() {\n                message.info('The post \"' + post.title + '\" has been removed.');\n                route.refresh();\n            }).catch(message.error);\n        }\n    };\n\n    return post;\n};\n",
    "var api = require('../api');\nvar assign = require('../assign');\nvar message = require('../message');\nvar expandable = require('./expandable');\n\n// Creates trash item view model.\n\nexports.create = function(data) {\n\n    var item = {};\n\n    // Make it expandable.\n    expandable.mixin(item);\n\n    // Copies data attributes.\n    assign(item, data);\n\n    // Removes from trash.\n    item.remove = function() {\n        if (confirm('Remove the entry from trash?')) {\n            api.removeFromTrash(item.$id).then(function() {\n                message.info('Item \"' + item.title + '\" has been removed.');\n                route.refresh();\n            }).catch(message.error);\n        }\n    };\n\n    // Restores the item.\n    item.restore = function() {\n        api.restore(item.$id).then(function() {\n            message.info('Item \"' + item.title + '\" has been restored.');\n            route.refresh();\n        }).catch(message.error);\n    };\n\n    return item;\n};\n",
    "var api = require('../api');\nvar assign = require('../assign');\nvar message = require('../message');\nvar expandable = require('./expandable');\n\n// Creates user view model for\n// the users list view.\n\nexports.create = function(data) {\n\n    var user = {\n        editable: false\n    };\n\n    // Make it expandable.\n    expandable.mixin(user);\n\n    // Copies data attributes.\n    assign(user, data);\n\n    // Removes the user.\n    // Asks confirmation.\n    user.remove = function() {\n        if (confirm('Remove the user?')) {\n            api.userInfo().then(function(userInfo) {\n                return api.removeUser(user.$id).then(function() {\n                    message.info('User \"' + user.username + '\" has been removed.');\n                    if (userInfo.$id === user.$id) {\n                        // User removed itself.\n                        sessionStorage.removeItem('api-key');\n                        localStorage.removeItem('api-key');\n                        window.location = '/admin';\n                    } else {\n                        route.refresh();\n                    }\n                });\n            }).catch(message.error);\n        }\n    };\n\n    return user;\n};\n"
  ]
}